<!DOCTYPE html>
<HTML lang="en">
    <HEAD>
        <META charset="utf-8"/>
        <TITLE>Online Booking System</TITLE>
        <LINK rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer"/>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
              rel="stylesheet"
              integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
              crossorigin="anonymous"/>

        <LINK href="/styles/grid.css"
              rel="stylesheet"/>

        <SCRIPT type="text/javascript" src="/javascript/bookingAPI.js"></SCRIPT>

        <SCRIPT type="text/javascript">
            window.onload = function() {
                const params = new Proxy(new URLSearchParams(window.location.search), {
                        get: (searchParams, prop) => searchParams.get(prop),
                    });

                const api = new BookingAPI();
                api.getFlight(params.id,
                    function (json) {
                        setTimeout(function () {
                            spinnerButton.style.display = "none";
                            flight.style.display = "";
                            document.getElementById("flight").value = json.number;
                            document.getElementById("tailNumber").value = json.aeroplane.tail_number;
                            document.getElementById("makeModel").value = json.aeroplane.make_model;
                            document.getElementById("departsAirport").value = json.departure_airport.name;
                            document.getElementById("departsDateTime").value = json.departure_date_time_utc;
                            document.getElementById("arrivesAirport").value = json.arrival_airport.name;
                            document.getElementById("arrivesDateTime").value = json.arrival_date_time_utc;
                            document.getElementById("flightTimeMins").value = json.flight_time_mins;
                        }, 1000);
                    },
                    function(code, json) {
                        document.getElementById("flight").value = "code: " + code + ", message: " + json.detail;
                    });
            }
        </SCRIPT>

    </HEAD>
    <BODY>
        <HEADER>
            <NAV class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
                <DIV class="container-fluid">
                    <A class="navbar-brand"
                       href="/">Home</A>
                    <BUTTON class="navbar-toggler"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#navbarCollapse"
                            aria-controls="navbarCollapse"
                            aria-expanded="false"
                            aria-label="Toggle navigation">
                        <SPAN class="navbar-toggler-icon"/>
                    </BUTTON>
                    <DIV class="collapse navbar-collapse"
                         id="navbarCollapse">
                        <UL class="navbar-nav me-auto mb-2 mb-md-0">
                            <LI class="nav-item">
                                <A class="nav-link active"
                                   href="/info/listFlights.html">Flights</A>
                            </LI>
                            <LI class="nav-item">
                                <A class="nav-link"
                                   href="/info/listAeroplanes.html">Aeroplanes</A>
                            </LI>
                            <LI class="nav-item">
                                <A class="nav-link"
                                   href="/user/editUser.html">User</A>
                            </LI>
                            <LI class="nav-item">
                                <A class="nav-link"
                                   href="/booking/listBookings.html">Bookings</A>
                            </LI>
                            <LI class="nav-item">
                                <BUTTON class="btn btn-success" type="button" onclick="window.location.href = '/booking/bookAFlight.html'">
                                    <i class="fa-solid fa-plane"></i>&nbsp;Book a Flight</BUTTON>
                            </LI>
                        </UL>
                    </DIV>
                </DIV>
            </NAV>
        </HEADER>

        <MAIN class="container">

            <header class="pb-3 mb-5 border-bottom">
                <h1 class="h1 d-flex align-items-center text-dark text-decoration-none">
                    <i class="fa-solid fa-earth-oceania"></i>
                    <span>&nbsp;Flight</span>
                </h1>
            </header>

            <FORM>
                <div class="col">
                    <label for="flight">Flight</label>
                    <input type="text" class="form-control" id="flight" placeholder="Flight" readonly style="display: none;">
                    <button class="form-control btn btn-outline-secondary text-start" type="button" id="spinnerButton" disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Loading...
                    </button>
                </div>
                <div class="row">
                    <div class="col">
                      <label for="tailNumber">Aeroplane Tail Number</label>
                      <input type="text" class="form-control" id="tailNumber" placeholder="Aeroplane Tail Number" readonly>
                    </div>
                    <div class="col">
                        <label for="makeModel">Aeroplane Make/Model</label>
                        <input type="text" class="form-control" id="makeModel" placeholder="Aeroplane Make/Model" readonly>
                    </div>
                    <div class="col">
                        <label for="makeModel">Flight Time (minutes)</label>
                        <input type="text" class="form-control" id="flightTimeMins" placeholder="Flight Time (minutes)" readonly>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                      <label for="departsAirport">Departure Airport</label>
                      <input type="text" class="form-control" id="departsAirport" placeholder="Departure Airport" readonly>
                    </div>
                    <div class="col">
                        <label for="departsDateTime">Departure Date/Time</label>
                        <input type="text" class="form-control" id="departsDateTime" placeholder="Departure Date/Time" readonly>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="arrivesAirport">Arrival Airport</label>
                        <input type="text" class="form-control" id="arrivesAirport" placeholder="Arrival Airport" readonly>
                    </div>
                    <div class="col">
                        <label for="arrivesDateTime">Arrival Date/Time</label>
                        <input type="text" class="form-control" id="arrivesDateTime" placeholder="Arrival Date/Time" readonly>
                    </div>
                </div>
            </FORM>
            <BR/>

            <FOOTER class="container">
                <P>Built by Damian Coventry, Copyright &copy; 2022, all rights reserved. &middot; <A href="#">Privacy</A> &middot; <A href="#">Terms</A>
                </P>
                <P>Flight icon created by Freepik &middot; <A href="https://www.flaticon.com/free-icons/plane" title="plane icons">Flaticon</A>
                </P>
            </FOOTER>
        </MAIN>

    </BODY>
</HTML>
