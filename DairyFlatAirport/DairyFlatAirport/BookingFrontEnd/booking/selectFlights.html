<!DOCTYPE html>
<HTML lang="en">
    <HEAD>
        <META charset="utf-8"/>
        <TITLE>Online Booking System</TITLE>

        <LINK href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
                integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"/>
        <LINK href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet"
                integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
                crossorigin="anonymous" referrerpolicy="no-referrer" />

        <LINK href="/styles/grid.css" rel="stylesheet"/>
        <LINK href="/styles/wizard.css" rel="stylesheet"/>

        <SCRIPT type="text/javascript" src="/javascript/bookingAPI.js"></SCRIPT>
        <SCRIPT type="text/javascript" src="/javascript/booking.js"></SCRIPT>

        <SCRIPT type="text/javascript">
            window.onload = function() {
                const booking = new Booking();

                fromCityName1.innerText = booking.getFromCityName();
                fromCityName2.innerText = booking.getFromCityName();
                fromCityName3.innerText = booking.getFromCityName();

                toCityName1.innerText = booking.getToCityName();
                toCityName2.innerText = booking.getToCityName();
                toCityName3.innerText = booking.getToCityName();
                numPassengers.innerText = booking.getNumPassengers();

                fromCityDate.innerText = toLocaleDate(new Date(booking.getLeaveDate()), booking.getTimezone());
                toCityDate.innerText = toLocaleDate(new Date(booking.getReturnDate()), booking.getTimezone());

                createFlightPagination(booking.getLeaveDate(), booking.getTimezone(), true, 'leaveDate');
                searchFlights(
                    1, // TODO: how to handle pagination?
                    "departsFlightTable",
                    booking.getFromCityId(), booking.getToCityId(),
                    booking.getLeaveDate(), booking.getTimezone(),
                    true);

                if (booking.isReturnTrip()) {
                    createFlightPagination(booking.getReturnDate(), booking.getTimezone(), false, 'returnDate');
                    searchFlights(
                        1, // TODO: how to handle pagination?
                        "arrivesFlightTable",
                        booking.getFromCityId(), booking.getToCityId(),
                        booking.getReturnDate(), booking.getTimezone(),
                        false);
                }
                else {
                    returnFlightGUI.style.display = 'none';
                    returnFlightItineraryGUI.style.display = 'none';
                }
            }

            function insertTableSpinner(flightTableName) {
                var table = document.getElementById(flightTableName);
                var oldTbody = table.tBodies[0];
                var newTbody = document.createElement("tbody");

                var newRow = newTbody.insertRow(-1);
                var newCell = newRow.insertCell(0);
                newCell.setAttribute('colspan', '6');

                var newDiv1 = document.createElement('div');
                newDiv1.setAttribute('class', 'text-center');
                newCell.appendChild(newDiv1);

                var newDiv2 = document.createElement('div');
                newDiv2.setAttribute('class', 'spinner-border');
                newDiv2.setAttribute('role', 'status');
                newDiv1.appendChild(newDiv2);

                var span = document.createElement('span');
                span.setAttribute('class', 'visually-hidden');
                span.innerText = 'Loading...';
                newDiv2.appendChild(span);

                oldTbody.parentNode.replaceChild(newTbody, oldTbody);
            }

            function fetchNewFlightData(flightTableName, dateObject, timezone, outbound) {
                insertTableSpinner(flightTableName);
                const booking = new Booking();
                searchFlights(1, flightTableName, booking.getFromCityId(), booking.getToCityId(), dateObject, timezone, outbound);
            }

            function searchFlights(currentPage, flightTableName, fromCity, toCity, leaveDate, timezone, outbound) {
                var options = {
                    departureCity: outbound ? fromCity : toCity,
                    arrivalCity: outbound ? toCity : fromCity,
                    departureDate: leaveDate,
                    timezone: timezone
                };

                const api = new BookingAPI();
                api.searchFlights(options, currentPage, function (json) {
                    setTimeout(function () {
                        const booking = new Booking();

                        var table = document.getElementById(flightTableName);
                        var oldTbody = table.tBodies[0];
                        var newTbody = document.createElement("tbody");

                        json.results.forEach(x => {
                            var newRow = newTbody.insertRow(-1);
                            var flightIdName = (outbound ? 'outboundFlightId' : 'inboundFlightId') + x.id;
                            var aeroplaneIdName = (outbound ? 'outboundAeroplaneId' : 'inboundAeroplaneId') + x.id;

                            var radio = document.createElement('input');
                            radio.setAttribute('type', 'radio');
                            radio.setAttribute('class', 'form-check-label');
                            radio.setAttribute('id', flightIdName);
                            radio.setAttribute('name', flightIdName);
                            if (outbound) {
                                radio.onchange = outboundRadioButtonClicked;
                                if (x.id == booking.getOutboundFlightId()) {
                                    radio.checked = true;
                                }
                            }
                            else {
                                radio.onchange = inboundRadioButtonClicked;
                                if (x.id == booking.getInboundFlightId()) {
                                    radio.checked = true;
                                }
                            }
                            var newCell = newRow.insertCell(0);
                            newCell.appendChild(radio);

                            var link = document.createElement('a');
                            link.setAttribute('href', "/info/viewAeroplane.html?id=" + x.aeroplane.id);
                            link.setAttribute('id', aeroplaneIdName);
                            link.setAttribute('name', aeroplaneIdName);
                            link.innerText = x.aeroplane.make_model;
                            newCell = newRow.insertCell(1);
                            newCell.appendChild(link);

                            newCell = newRow.insertCell(2);
                            var span = document.createElement('span');
                            span.setAttribute('id', (outbound ? 'outboundTime' : 'inboundTime') + x.id);
                            span.appendChild(document.createTextNode(toLocaleTime(x.departure_date_time_utc, x.departure_airport.timezone)));
                            newCell.appendChild(span);

                            var small = document.createElement('small');
                            small.setAttribute('class', 'text-muted fst-italic');
                            small.setAttribute('style', 'font-size: x-small');
                            small.innerText = ' ' + x.departure_airport.timezone + ' time';
                            newCell.appendChild(small);

                            newCell = newRow.insertCell(3);
                            newCell.appendChild(document.createTextNode(toLocaleTime(x.arrival_date_time_utc, x.arrival_airport.timezone)));

                            small = document.createElement('small');
                            small.setAttribute('id', (outbound ? 'outboundTimezone' : 'inboundTimezone') + x.id);
                            small.setAttribute('class', 'text-muted fst-italic');
                            small.setAttribute('style', 'font-size: x-small');
                            small.innerText = ' ' + x.arrival_airport.timezone + ' time';
                            newCell.appendChild(small);

                            newCell = newRow.insertCell(4);
                            var s = '';
                            var h = Math.floor(x.flight_time_mins/60);
                            if (h > 0) {
                                s += h + 'h ';
                            }
                            newCell.appendChild(document.createTextNode(s + (x.flight_time_mins%60) + 'm'));

                            newCell = newRow.insertCell(5);
                            span = document.createElement('span');
                            span.appendChild(document.createTextNode('$'));
                            newCell.appendChild(span);

                            span = document.createElement('span');
                            span.setAttribute('id', (outbound ? 'outboundCost' : 'inboundCost') + x.id);
                            span.appendChild(document.createTextNode(x.cost_dollars));
                            newCell.appendChild(span);
                        });

                        if (json.results.length == 0) {
                            var newRow = newTbody.insertRow(-1);

                            var newCell = newRow.insertCell(0);
                            newCell.setAttribute('colspan', '6');

                            var div1 = document.createElement('div');
                            div1.setAttribute('class', 'row');

                            var div2 = document.createElement('div');
                            div2.setAttribute('class', 'col text-center');

                            var span = document.createElement('span');
                            span.setAttribute('class', 'fst-italic');
                            span.innerText = 'There are no flights from ';
                            div2.appendChild(span);

                            span = document.createElement('span');
                            span.setAttribute('class', 'fst-italic fw-bold text-success');
                            span.innerText = outbound ? booking.getFromCityName() : booking.getToCityName();
                            div2.appendChild(span);

                            span = document.createElement('span');
                            span.setAttribute('class', 'fst-italic');
                            span.innerText = ' to ';
                            div2.appendChild(span);

                            span = document.createElement('span');
                            span.setAttribute('class', 'fst-italic fw-bold text-success');
                            span.innerText = outbound ? booking.getToCityName() : booking.getFromCityName();
                            div2.appendChild(span);

                            span = document.createElement('span');
                            span.setAttribute('class', 'fst-italic');
                            span.innerText = ' on this date.';
                            div2.appendChild(span);

                            div1.appendChild(div2);                            
                            newCell.appendChild(div1);
                        }

                        oldTbody.parentNode.replaceChild(newTbody, oldTbody);

                        enableOrDisableNextButton();
                        updateItineraryTotalCost();

                        if (outbound) {
                            updateItineraryDateTime(fromCityTime, true);
                        }
                        else {
                            updateItineraryDateTime(toCityTime, false);
                        }
                    }, 500);
                },
                function(code, json) {
                    var table = document.getElementById(flightTableName);
                    var oldTbody = table.tBodies[0];
                    var newTbody = document.createElement("tbody");

                    var newRow = newTbody.insertRow(-1);
                    var newCell = newRow.insertCell(0);
                    newCell.appendChild(document.createTextNode("code: " + code + ", message: " + json.detail));

                    oldTbody.parentNode.replaceChild(newTbody, oldTbody);
                });
            }

            function outboundRadioButtonClicked(event) {
                uncheckOtherRadioButtons('outboundFlightId', event);
                enableOrDisableNextButton();
                updateItineraryDateTime(fromCityTime, true);
                updateItineraryTotalCost();
            }

            function inboundRadioButtonClicked(event) {
                uncheckOtherRadioButtons('inboundFlightId', event);
                enableOrDisableNextButton();
                updateItineraryDateTime(toCityTime, false);
                updateItineraryTotalCost();
            }

            function uncheckOtherRadioButtons(namePrefix, event) {
                if (!event.currentTarget.checked) {
                    return;
                }
                var radioButtons = document.getElementsByTagName('input');
                for (var i = 0; i < radioButtons.length; ++i) {
                    var x = radioButtons[i];
                    if (x.getAttribute('type') == 'radio' && x.name.substring(0, namePrefix.length) == namePrefix) {
                        x.checked = (event.currentTarget.id == x.id);
                    }
                }
            }

            function updateItineraryDateTime(updateThisSpan, outbound) {
                var flightPrefix = '', timePrefix = '', timezonePrefix = '';
                if (outbound) {
                    flightPrefix = 'outboundFlightId';
                    timePrefix = 'outboundTime';
                    timezonePrefix = 'outboundTimezone';
                }
                else {
                    flightPrefix = 'inboundFlightId';
                    timePrefix = 'inboundTime';
                    timezonePrefix = 'inboundTimezone';
                }

                var timePrefixSpan = getChosenFlightValue('span', flightPrefix, timePrefix);
                var timezonePrefixSpan = getChosenFlightValue('small', flightPrefix, timezonePrefix);

                if (timePrefixSpan != null && timezonePrefixSpan != null) {
                    updateThisSpan.innerHTML =
                            '<span>' + timePrefixSpan + '</span> ' +
                            '<small class="text-muted fst-italic" style="font-size: x-small">' + timezonePrefixSpan + '</small>';
                }
                else {
                    updateThisSpan.innerHTML = '';
                }
            }

            function updateItineraryTotalCost() {
                var cost = 0;

                var outboundCost = getChosenFlightValue('span', 'outboundFlightId', 'outboundCost');
                if (outboundCost != null) {
                    cost += parseInt(outboundCost);
                }

                const booking = new Booking();
                if (booking.isReturnTrip()) {
                    var inboundCost = getChosenFlightValue('span', 'inboundFlightId', 'inboundCost');
                    if (inboundCost != null) {
                        cost += parseInt(inboundCost);
                    }
                }

                totalCost.innerText = parseInt(numPassengers.innerText) * cost;
            }

            function enableOrDisableNextButton() {
                var outboundChecked = isRadioButtonChecked('outboundFlightId');

                var inboundChecked = true;
                const booking = new Booking();
                if (booking.isReturnTrip()) {
                    inboundChecked = isRadioButtonChecked('inboundFlightId');
                }

                nextButton.disabled = !outboundChecked || !inboundChecked;
                if (nextButton.disabled) {
                    nextButton.setAttribute('class', 'btn btn-primary mb-4 disabled');
                }
                else {
                    nextButton.setAttribute('class', 'btn btn-primary mb-4');
                }
            }

            function isRadioButtonChecked(namePrefix) {
                var radioButtons = document.getElementsByTagName('input');
                for (var i = 0; i < radioButtons.length; ++i) {
                    var x = radioButtons[i];
                    if (x.getAttribute('type') == 'radio' && x.name.substring(0, namePrefix.length) == namePrefix && x.checked) {
                        return true;
                    }
                }
                return false;
            }

            function getChosenFlightId(namePrefix) {
                var radioButtons = document.getElementsByTagName('input');
                for (var i = 0; i < radioButtons.length; ++i) {
                    var x = radioButtons[i];
                    if (x.getAttribute('type') == 'radio' && x.name.substring(0, namePrefix.length) == namePrefix && x.checked) {
                        return x.name.substring(namePrefix.length);
                    }
                }
                return null;
            }

            function getChosenAeroplaneId(namePrefix) {
                var anchors = document.getElementsByTagName('a');
                for (var i = 0; i < anchors.length; ++i) {
                    if (anchors[i].name.substring(0, namePrefix.length) == namePrefix) {
                        const re = /\?id=(.+)$/;
                        const id = re.exec(anchors[i].href);
                        if (id != null && id.length > 1) {
                            return parseInt(id[1]);
                        }
                    }
                }
                return null;
            }

            function getChosenFlightValue(tagName, flightNamePrefix, spanValuePrefix) {
                var chosenFlightId = getChosenFlightId(flightNamePrefix);
                if (chosenFlightId == null) {
                    return null;
                }

                var spans = document.getElementsByTagName(tagName);
                for (var i = 0; i < spans.length; ++i) {
                    if (spans[i].id.substring(0, spanValuePrefix.length) == spanValuePrefix) {
                        var spanFlightId = spans[i].id.substring(spanValuePrefix.length);
                        if (spanFlightId == chosenFlightId) {
                            return spans[i].innerText;
                        }
                    }
                }
                return null;
            }

            function toLocaleTime(dateTime, timezone) {
                return new Date(dateTime).toLocaleTimeString([],
                                {
                                    timeZone: timezone,
                                    hour: 'numeric',
                                    minute: '2-digit',
                                    hour12: true
                                });
            }

            function appendDate(list, dateObject, text, active, timezone, outbound, hiddenId) {
                var li = document.createElement("li");
                li.setAttribute("class", active ? "page-item active" : "page-item");

                var e;
                if (active) {
                    e = document.createElement("span");
                }
                else {
                    e = document.createElement("a");
                    e.setAttribute('href', "javascript:changeFlightDate('"+dateObject.toISOString()+"', '"+timezone+"', "+outbound+", '"+hiddenId+"')");
                }

                e.setAttribute("class", "page-link");
                e.innerHTML = text;
                li.appendChild(e);

                list.appendChild(li);
            }

            function changeFlightDate(dateString, timezone, outbound, hiddenId) {
                var dateObject = new Date(dateString);
                changeFlightPagination(dateObject, timezone, outbound, hiddenId);

                if (outbound) {
                    fetchNewFlightData('departsFlightTable', dateObject, timezone, true);
                    updateItineraryDateTime(fromCityTime, true);
                }
                else {
                    fetchNewFlightData('arrivesFlightTable', dateObject, timezone, false);
                    updateItineraryDateTime(toCityTime, false);
                }

                nextButton.disabled = true;
                updateItineraryTotalCost();
            }

            function createFlightPagination(dateString, timezone, outbound, hiddenId) {
                changeFlightPagination(new Date(dateString), timezone, outbound, hiddenId)
            }

            function changeFlightPagination(dateObject, timezone, outbound, hiddenId) {
                var pagination = (outbound ? departsDatePagination : arrivesDatePagination);
                while (pagination.hasChildNodes()) {
                    pagination.removeChild(pagination.firstChild);
                }

                const api = new BookingAPI();
                const booking = new Booking();
                if (outbound) {
                    fromCityDate.innerText = toLocaleDate(new Date(dateObject), timezone);
                    booking.setLeaveDate(api.toYYYYMMDD(dateObject));
                }
                else {
                    toCityDate.innerText = toLocaleDate(new Date(dateObject), timezone);
                    booking.setReturnDate(api.toYYYYMMDD(dateObject));
                }

                var d = new Date();
                d.setDate(dateObject.getDate() - 1);
                appendDate(pagination, d, "&laquo;", false, timezone, outbound, hiddenId);

                d = new Date();
                d.setDate(dateObject.getDate() - 2);
                appendDate(pagination, d, toLocaleDate(d, timezone), false, timezone, outbound, hiddenId);

                d = new Date();
                d.setDate(dateObject.getDate() - 1);
                appendDate(pagination, d, toLocaleDate(d, timezone), false, timezone, outbound, hiddenId);

                appendDate(pagination, null, toLocaleDate(dateObject, timezone), true, timezone, outbound, hiddenId);
                var hidden = document.getElementById(hiddenId);
                hidden.value = api.toYYYYMMDD(dateObject);

                d = new Date();
                d.setDate(dateObject.getDate() + 1);
                appendDate(pagination, d, toLocaleDate(d, timezone), false, timezone, outbound, hiddenId);

                d = new Date();
                d.setDate(dateObject.getDate() + 2);
                appendDate(pagination, d, toLocaleDate(d, timezone), false, timezone, outbound, hiddenId);

                d = new Date();
                d.setDate(dateObject.getDate() + 1);
                appendDate(pagination, d, "&raquo;", false, timezone, outbound, hiddenId);
            }

            function toLocaleDate(dateTime, timezone) {
                return new Date(dateTime).toLocaleDateString([],
                                {
                                    timeZone: timezone,
                                    weekday: 'short',
                                    day: 'numeric',
                                    month: 'short'
                                });
            }

            function previousButtonClicked() {
                window.location.href = "/booking/bookAFlight.html?source=session";
            }

            function nextButtonClicked() {
                var inboundFlightId = getChosenFlightId('inboundFlightId');
                var inboundAeroplaneId = getChosenAeroplaneId('inboundAeroplaneId');
                const booking = new Booking();
                booking.setOutboundFlightId(getChosenFlightId('outboundFlightId'));
                booking.setOutboundAeroplaneId(getChosenAeroplaneId('outboundAeroplaneId'));
                booking.setInboundFlightId(inboundFlightId == null ? '' : inboundFlightId);
                booking.setInboundAeroplaneId(inboundAeroplaneId == null ? '' : inboundAeroplaneId);
                booking.setTotalCost(totalCost.innerText);
                booking.setLeaveTime(fromCityTime.innerText);
                booking.setReturnTime(toCityTime.innerText);
                window.location.href = "/booking/passengerDetails.html";
            }
        </SCRIPT>
    </HEAD>
    <BODY>
        <NAV class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
            <DIV class="container-fluid">
                <A class="navbar-brand" href="/">Home</A>
                <BUTTON class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <SPAN class="navbar-toggler-icon"/>
                </BUTTON>
                <DIV class="collapse navbar-collapse" id="navbarCollapse">
                    <UL class="navbar-nav me-auto mb-2 mb-md-0">
                        <LI class="nav-item">
                            <A class="nav-link active" href="/info/listFlights.html">Flights</A>
                        </LI>
                        <LI class="nav-item">
                            <A class="nav-link" href="/info/listAeroplanes.html">Aeroplanes</A>
                        </LI>
                        <LI class="nav-item">
                            <A class="nav-link" href="/user/editUser.html">User</A>
                        </LI>
                        <LI class="nav-item">
                            <A class="nav-link" href="/booking/listBookings.html">Bookings</A>
                        </LI>
                        <LI class="nav-item">
                            <BUTTON class="btn btn-success" type="button" onclick="window.location.href = '/booking/bookAFlight.html'">
                                <i class="fa-solid fa-plane"></i>&nbsp;Book a Flight</BUTTON>
                        </LI>
                    </UL>
                </DIV>
            </DIV>
        </NAV>
        <MAIN class="container">
            <HEADER class="pb-3 mt-3 mb-5 border-bottom">
                <H1 class="h1 d-flex align-items-center text-dark text-decoration-none">
                    <i class="fa-solid fa-plane"></i>
                    <SPAN>&nbsp;Book a Flight</SPAN>
                </H1>
            </HEADER>

            <DIV class="row mb-5">
                <ul class="wizard-progress">
                    <li class="wizard-step completed" id="searchStep" onclick="window.location.href='/booking/bookAFlight.html?source=session';">Search</li>
                    <li class="wizard-step active" id="searchFlights">Flights</li>
                    <li class="wizard-step" id="searchPassengers">Passengers</li>
                    <li class="wizard-step" id="searchExtras">Extras</li>
                    <li class="wizard-step" id="searchSeats">Seats</li>
                    <li class="wizard-step" id="searchConfirm">Confirm</li>
                    <li class="wizard-step" id="searchInvoice">Invoice</li>
                </ul>
            </DIV>

            <div class="row">
                <div class="col-md-9">
                    <h4 class="mb-2 text-primary">Available Flights</h4>

                    <div class="fs-5 mb-4">
                        Select your flight to <span class="text-success fw-bold text-decoration-underline" id="toCityName1"></span>
                    </div>

                    <nav>
                        <input type="hidden" id="leaveDate"/>
                        <ul id="departsDatePagination" class="pagination justify-content-center">
                            <li class="page-item">
                                <a class="page-link" href="javascript:;">&laquo;</a>
                            </li>
                            <li class="page-item">

                                <div class="page-link">
                                    <div class="spinner-border spinner-border-sm" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                </div>
                            
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="javascript:;">&raquo;</a>
                            </li>
                        </ul>
                    </nav>

                    <table id="departsFlightTable" class="table table-striped table-hover mb-5">
                        <thead>
                            <tr>
                                <th scope="col">&nbsp;</th>
                                <th scope="col">Aeroplane</th>
                                <th scope="col">Departs</th>
                                <th scope="col">Arrives</th>
                                <th scope="col">Flight Time</th>
                                <th scope="col">Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="6">
                                    <div class="text-center">
                                        <div class="spinner-border" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <span id="returnFlightGUI">
                        <div class="my-5">&nbsp;</div>

                        <div class="fs-5 mt-5 mb-4">
                            Select your return flight to <span class="text-success fw-bold text-decoration-underline" id="fromCityName1"></span>
                        </div>

                        <nav>
                            <input type="hidden" id="returnDate"/>
                            <ul id="arrivesDatePagination" class="pagination justify-content-center">
                                <li class="page-item">
                                    <a class="page-link" href="javascript:;">&laquo;</a>
                                </li>
                                <li class="page-item">

                                    <div class="page-link">
                                        <div class="spinner-border spinner-border-sm" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                
                                </li>
                                <li class="page-item">
                                    <a class="page-link" href="javascript:;">&raquo;</a>
                                </li>
                            </ul>
                        </nav>

                        <table id="arrivesFlightTable" class="table table-striped table-hover mb-5">
                            <thead>
                                <tr>
                                    <th scope="col">&nbsp;</th>
                                    <th scope="col">Aeroplane</th>
                                    <th scope="col">Departs</th>
                                    <th scope="col">Arrives</th>
                                    <th scope="col">Flight Time</th>
                                    <th scope="col">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="6">
                                        <div class="text-center">
                                            <div class="spinner-border" role="status">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </span>

                    <div class="row justify-content-between">
                        <div class="col col-md-auto">
                            <button class="btn btn-secondary mb-4" onclick="previousButtonClicked();">
                                <i class="fa-solid fa-circle-arrow-left"></i>&nbsp;Previous
                            </button>
                        </div>
                        <div class="col col-md-auto">
                            <button class="btn btn-primary mb-4 disabled" id="nextButton" onclick="nextButtonClicked();">
                                Next&nbsp;<i class="fa-solid fa-circle-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 col-lg-3 order-md-last">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="text-primary">Your Itinerary</h4>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title mt-4">Outbound trip</h5>
                            <p class="card-text my-0">
                                <span class="text-success fw-bold" id="fromCityName2"></span> to <span class="text-success fw-bold" id="toCityName2"></span>
                            </p>
                            <p class="card-text mt-0">
                                <span id="fromCityDate"></span>&nbsp;<span id="fromCityTime"></span>
                            </p>
                            <span id="returnFlightItineraryGUI">
                                <h5 class="card-title mt-5">Return trip</h5>
                                <p class="card-text my-0">
                                    <span class="text-success fw-bold" id="toCityName3"></span> to <span class="text-success fw-bold" id="fromCityName3"></span>
                                </p>
                                <p class="card-text mt-0 mb-4">
                                    <span id="toCityDate"></span>&nbsp;<span id="toCityTime"></span>
                                </p>
                            </span>
                            <p class="card-text mb-1">
                                <div class="row">
                                    <span class="col">Num Passengers </span>
                                    <strong class="col text-end" id="numPassengers">1</strong>
                                </div>
                            </p>
                        </div>
                        <div class="card-footer">
                            <div class="row">
                                <span class="col">Total (NZD)</span>
                                <strong class="col text-end">$<span id="totalCost">0</span></strong>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <FOOTER class="container">
                <P>Built by Damian Coventry, Copyright &copy; 2022, all rights reserved. &middot; <A href="javascript:;">Privacy</A> &middot; <A href="javascript:;">Terms</A>
                </P>
                <P>Flight icon created by Freepik &middot; <A href="https://www.flaticon.com/free-icons/plane" title="plane icons">Flaticon</A>
                </P>
            </FOOTER>
        </MAIN>
        <SCRIPT src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
        </SCRIPT>
    </BODY>
</HTML>
